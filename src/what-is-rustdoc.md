# ä»€ä¹ˆæ˜¯ rustdocï¼Ÿ

> ä¸­æ–‡ç¿»è¯‘æ³¨ï¼ˆThe Chinese translation of [The rustdoc Book][website]ï¼‰ï¼š
>
> - ğŸ‘‰ æŸ¥çœ‹æ›´å¤š <a href="https://rustwiki.org/" style="color:#97ca00;font-weight:bold;">Rust å®˜æ–¹æ–‡æ¡£ä¸­è‹±æ–‡åŒè¯­æ•™ç¨‹</a>ï¼ŒåŒ…æ‹¬åŒè¯­ç‰ˆ[ã€ŠRust ç¨‹åºè®¾è®¡è¯­è¨€ã€‹][book-cn]ï¼ˆå‡ºç‰ˆä¹¦åä¸ºã€ŠRust æƒå¨æŒ‡å—ã€‹ï¼‰ï¼Œæœ¬ç«™è¿˜æä¾›äº† [Rust æ ‡å‡†åº“ä¸­æ–‡ç‰ˆ][std-cn]ã€‚
> - ã€Šrustdoc æ‰‹å†Œã€‹ï¼ˆ*rustdoc Book* ä¸­æ–‡ç‰ˆï¼‰ç¿»è¯‘è‡ª [*rustdoc Book*][website]ï¼Œå†…å®¹å·²å…¨éƒ¨ç¿»è¯‘å®Œæˆï¼ŒæŸ¥çœ‹æ­¤ä¹¦çš„ [Github ç¿»è¯‘é¡¹ç›®å’Œæºç ][github-src]ã€‚
> - æœ¬æ–‡ç‰ˆæœ€åæ›´æ–°æ—¶é—´ï¼š2022-02-04ã€‚
> - æœ¬æ–‡æ¡£å·²åŠ å…¥åˆ° [Rust ä¸­æ–‡ç¿»è¯‘é¡¹ç›®ç»„][rust-lang-cn]ï¼Œä¸»è¦è¯‘è€…ï¼š[*David*][david]ï¼Œ[Rust ä¸­æ–‡ç¿»è¯‘é¡¹ç›®ç»„][rust-lang-cn] äº¤æµç¾¤æˆå‘˜ã€‚
> - <a href="https://rustwiki.org/en/rustdoc/" style="color:red;">æœ¬ç«™æ”¯æŒæ–‡æ¡£ä¸­è‹±æ–‡åˆ‡æ¢</a>ï¼Œç‚¹å‡»é¡µé¢å³ä¸Šè§’è¯­è¨€å›¾æ ‡å¯åˆ‡æ¢åˆ°ç›¸åŒç« èŠ‚çš„è‹±æ–‡é¡µé¢ï¼Œ**è‹±æ–‡ç‰ˆæ¯å¤©éƒ½ä¼šè‡ªåŠ¨åŒæ­¥ä¸€æ¬¡å®˜æ–¹çš„æœ€æ–°ç‰ˆæœ¬**ã€‚
> - è‹¥å‘ç°å½“å‰é¡µè¡¨è¾¾é”™è¯¯æˆ–å¸®åŠ©æˆ‘ä»¬æ”¹è¿›ç¿»è¯‘ï¼Œå¯ç‚¹å‡»å³ä¸Šè§’çš„ç¼–è¾‘æŒ‰é’®æ‰“å¼€è¯¥é¡µå¯¹åº”æºç æ–‡ä»¶è¿›è¡Œç¼–è¾‘å’Œä¿®æ”¹ï¼ŒRust ä¸­æ–‡èµ„æºçš„å¼€æºç»„ç»‡å‘å±•ç¦»ä¸å¼€å¤§å®¶ï¼Œæ„Ÿè°¢æ‚¨çš„æ”¯æŒå’Œå¸®åŠ©ï¼

æ ‡å‡† Rust ç‰ˆæœ¬åŒ…å«äº†åä¸º `rustdoc` çš„å·¥å…·ã€‚å®ƒçš„ä½œç”¨æ˜¯ä¸º Rust é¡¹ç›®ç”Ÿæˆæ–‡æ¡£ï¼ŒRustdoc æ¥å—ä¸€ä¸ª crate æ ¹ç›®å½•æˆ–è€…ä¸€ä¸ª markdown æ–‡ä»¶ä½œä¸ºå‚æ•°ï¼Œç”Ÿæˆ HTMLï¼ŒCSS å’Œ Javascript æ–‡ä»¶ã€‚

## åŸºæœ¬ä½¿ç”¨

è®©æˆ‘ä»¬è¯•ç”¨ä¸€ä¸‹ï¼Œä½¿ç”¨ Cargo åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®

```bash
$ cargo new docs --lib
$ cd docs
```

åœ¨ `src/lib.rs` ä¸­ï¼ŒCargo ç”Ÿæˆäº†ä¸€äº›äº‹ä¾‹ä»£ç ï¼Œåˆ æ‰ä½¿ç”¨ä¸‹é¢çš„ä»£ç ä»£æ›¿

```rust
/// foo is a function
fn foo() {}
```

ç„¶åæˆ‘ä»¬è¿è¡Œ `rustdoc` ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ crate æ ¹ç›®å½•æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤

```bash
$ rustdoc src/lib.rs
```
è¿™ä¼šåˆ›å»ºä¸€ä¸ªæ–°ç›®å½•`doc`ï¼Œå…¶ä¸­æ˜¯ä¸€ä¸ªç½‘ç«™ç»“æ„ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œä¸»é¡µé¢æ˜¯ `doc/lib/index.html`ã€‚å¦‚æœä½ ä½¿ç”¨æµè§ˆå™¨æ‰“å¼€ï¼Œå¯ä»¥åœ¨ tab æ çœ‹åˆ° "Crate lib"ï¼Œé¡µé¢æ²¡æœ‰å†…å®¹ã€‚

## é…ç½® rustdoc

ç°åœ¨æœ‰ä¸¤ä¸ªé—®é¢˜ï¼šç¬¬ä¸€ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬çš„åŒ…åå­—æ˜¯ "lib"ï¼Ÿç¬¬äºŒï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰ä»»ä½•å†…å®¹ï¼Ÿ

ç¬¬ä¸€ä¸ªé—®é¢˜çš„åŸå› æ˜¯å› ä¸º`rustdoc`è¯•å›¾æ›´å¥½ç”¨ï¼Œåƒ`rustc`å°±å‡å®šæˆ‘ä»¬ crate çš„åå­—å°±æ˜¯ crate æ ¹ç›®å½•æ–‡ä»¶çš„åå­—ã€‚ä¸ºäº†ä¿®å¤è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥é€šè¿‡å‘½ä»¤è¡Œä¼ é€’å‚æ•°ï¼š

```bash
$ rustdoc src/lib.rs --crate-name docs
```

ç°åœ¨ï¼Œ `doc/docs/index.html` æ–‡ä»¶ç”Ÿæˆï¼Œé¡µé¢åç§°ä¸º "Crate docs"ã€‚

å¯¹äºç¬¬äºŒä¸ªé—®é¢˜ï¼Œå› ä¸ºæˆ‘ä»¬çš„å‡½æ•°`foo`ä¸æ˜¯å…¬å…±çš„ï¼›`rustdoc`é»˜è®¤åªä¼šä¸ºå…¬å…±å‡½æ•°ç”Ÿæˆæ–‡æ¡£ï¼Œå¦‚æœæˆ‘ä»¬å°†ä»£ç ä¿®æ”¹ä¸º

```rust
/// foo is a function
pub fn foo() {}
```

ç„¶åé‡æ–°è¿è¡Œ `rustdoc`:

```bash
$ rustdoc src/lib.rs --crate-name docs
```

ç°åœ¨æˆ‘ä»¬ç”Ÿæˆäº†æ–‡æ¡£ï¼Œæ‰“å¼€`doc/docs/index.html`ï¼Œæ˜¾ç¤ºäº†`foo`å‡½æ•°çš„è¿æ¥é¡µé¢ï¼Œæ–‡ä»¶ä½ç½®æ˜¯`doc/docs/fn.foo.html`ã€‚åœ¨å‡½æ•°çš„é¡µé¢ä¸Šï¼Œä½ å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å†™çš„æ³¨é‡Š"foo is a function"ã€‚

## é€šè¿‡ Cargo ä½¿ç”¨ rustdoc

Cargo æ•´åˆäº†`rustdoc`ï¼Œä½¿å¾—ç”Ÿæˆæ–‡æ¡£æ›´å®¹æ˜“ã€‚ä»£æ›¿`rustdoc`å‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼š

```bash
$ cargo doc
```

å®é™…ä¸Šï¼Œä¼šè¿™æ ·è°ƒç”¨`rustdoc`:

```bash
$ rustdoc --crate-name docs src/lib.rs -o <path>/docs/target/doc -L
dependency=<path>/docs/target/debug/deps
```

ä½ å¯ä»¥ä½¿ç”¨`cargo doc --verbose`çœ‹åˆ°è¿™ä¸ªè¿‡ç¨‹ã€‚

å®ƒä¼šè‡ªåŠ¨ç”Ÿæˆæ­£ç¡®çš„ crate åç§°`--crate-name`ï¼ŒåŒæ—¶æŒ‡å‘`src/lib.rs`ã€‚ä½†æ˜¯å…¶ä»–çš„å‚æ•°è¡¨ç¤ºä»€ä¹ˆå‘¢ï¼Ÿ

 - `-o` æ§åˆ¶æ–‡æ¡£çš„è¾“å‡ºã€‚ä¸ä½¿ç”¨é¡¶å±‚çš„`doc` ç›®å½•ï¼ŒCargo ä¼šæŠŠç”Ÿæˆçš„æ–‡æ¡£ç”Ÿæˆåœ¨  `target`ã€‚è¿™æ˜¯ Cargo é¡¹ç›®çš„æƒ¯ç”¨ç”Ÿæˆæ–‡ä»¶çš„ä½ç½®ã€‚
 - `-L` å¸®åŠ© rustdoc æ‰¾åˆ°ä»£ç çš„ä¾èµ–ï¼Œå¦‚æœæˆ‘ä»¬çš„é¡¹ç›®æœ‰ä¾èµ–ï¼Œä¹Ÿä¼šç”Ÿæˆä¾èµ–çš„æ–‡æ¡£ã€‚

## Outer å’Œ inner æ–‡æ¡£

`///` è¯­æ³•ç”¨æ¥å¯¹ä¸‹é¢ä¸€ä¸ª item ç”Ÿæˆæ–‡æ¡£ï¼Œæ‰€ä»¥ç§°ä¸º outer æ–‡æ¡£ã€‚è¿˜æœ‰è¯­æ³•`//!`ï¼Œç”¨æ¥ç”Ÿæˆ item å†…éƒ¨çš„æ–‡æ¡£ï¼Œä¹Ÿå«åš inner æ–‡æ¡£ï¼Œé€šå¸¸ç”¨æ¥å¯¹æ•´ä¸ª crate ç”Ÿæˆæ–‡æ¡£ï¼Œå› ä¸ºæ˜¯ crate çš„æ ¹ï¼Œæ²¡æœ‰ item åœ¨å‰é¢ã€‚æ‰€ä»¥ä¸ºäº†ç”Ÿæˆæ•´ä¸ª crate çš„æ–‡æ¡£ï¼Œä½ éœ€è¦è¿™æ ·ç”¨ `//!`ï¼š

``` rust
//! This is my first rust crate
```

å½“è¿™æ ·ç”¨çš„æ—¶å€™ï¼Œä¼šç”Ÿæˆ item å†…éƒ¨çš„æ–‡æ¡£ï¼Œä¹Ÿå°±æ˜¯ crate è‡ªå·±ã€‚

ä¸ºäº†è·å–æ›´å¤š`//!`çš„ä¿¡æ¯ï¼Œè¯·çœ‹ [the Book]( https://doc.rust-lang.org/book/ch14-02-publishing-to-crates-io.html#commenting-contained-items)

## åˆ©ç”¨å•ç‹¬çš„ Markdown æ–‡ä»¶

`rustdoc` å¯ä»¥ä¸ºå•ç‹¬çš„ markdown æ–‡ä»¶ç”Ÿæˆ HTMLã€‚è®©æˆ‘ä»¬å°è¯•ä¸€ä¸‹ï¼Œåˆ›å»º`README.md`ï¼Œå¹¶è¾“å…¥å¦‚ä¸‹å†…å®¹

````text
# Docs

This is a project to test out `rustdoc`.

[Here is a link!](https://www.rust-lang.org)

## Example

```rust
fn foo() -> i32 {
    1 + 1
}
```
````

ç„¶åè¿è¡Œ `rustdoc` å‘½ä»¤ï¼š

```bash
$ rustdoc README.md
```

ä½ èƒ½å‘ç°ç”Ÿæˆçš„`docs/doc/README.html`æ–‡ä»¶ã€‚

ä¸è¿‡ç°åœ¨ Cargo ä¸èƒ½è¿™æ ·æ“ä½œ markdown æ–‡ä»¶ã€‚

## æ€»ç»“

æœ¬èŠ‚æ¶µç›–äº†`rustdoc`çš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•ã€‚æœ¬ä¹¦çš„å‰©ä½™éƒ¨åˆ†ä¼šå±•ç¤º`rustdoc`æ‰€æœ‰çš„å¯é€‰åŠŸèƒ½ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒä»¬ã€‚

[website]: https://doc.rust-lang.org/rustdoc/
[book-cn]: https://rustwiki.org/zh-CN/book/
[std-cn]: https://rustwiki.org/zh-CN/std/
[github-src]: https://github.com/rust-lang-cn/rustdoc-cn
[rust-lang-cn]: https://github.com/rust-lang-cn
[david]: https://github.com/wendajiang
